Manual processing of distribution plots to determine cutoffs for split
investigations. In short, I'm going through all of the figures in the ~bonds~,
~angles~, and ~torsions~ directories and determining what sections of the
distributions are interesting to visualize. For example, in the first bond
image, shown below, there appears to be a bimodal distribution of Espaloma
parameters assigned to the same Sage parameter. In the shorthand described in
the table ~cutoff-key~, I would assign this parameter ~<~, which means the
interesting molecules are those with Espaloma parameters less than the Sage
value.

#+ATTR_HTML: :width 600
[[file:bonds/00002.png]]

#+name: cutoff-key
| Symbol | Meaning                  |
|--------+--------------------------|
| <      | Less than Sage average   |
| <N     | Less than N              |
| >      | Greater than Sage averag |
| >N     | Greater than N           |
| n      | don't examine            |

#+name: to-python
#+begin_src awk
  NR > 1 {
      if ($NF ~ /(<|>)[0-9]/) {
	  print $1, $NF
      } else if ($NF ~ /<|>/) {
	  print $1, $NF""$2
      }
  }
#+end_src

#+call: to-python[:stdin bond-labeling :results file :file labeled_bonds.dat]()

#+RESULTS:
[[file:labeled_bonds.dat]]

* Bonds

  #+name: bond-labeling
  | SMIRKS                             |   Sage | Espaloma | Cutoff |
  |------------------------------------+--------+----------+--------|
  | [#6X4:1]-[#1:2]                    |  719.6 |    741.5 | <      |
  | [#6X3:1]:[#6X3:2]                  |  765.1 |    843.5 | <      |
  | [#6X3:1]-[#1:2]                    |  775.4 |    793.7 | <      |
  | [#6X4:1]-[#6X4:2]                  |  420.0 |    487.2 | <      |
  | [#6X4:1]-[#6X3:2]                  |  484.2 |    552.7 | <      |
  | [#7:1]-[#1:2]                      |  964.7 |    905.9 | n      |
  | [#6:1]-[#7:2]                      |  457.1 |    522.0 | <      |
  | [#6X3:1]-[#7X3:2]                  |  640.6 |    724.8 | n      |
  | [#6X4:1]-[#8X2H0:2]                |  434.3 |    547.8 | <      |
  | [#6X3:1]-[#6X3:2]                  |  540.3 |    579.9 | <400   |
  | [#6:1]=[#8X1+0,#8X2+1:2]           | 1527.0 |   1571.2 | <1200  |
  | [#6X3:1]=[#6X3:2]                  |  898.6 |    975.7 | <      |
  | [#6X3:1](=[#8X1+0])-[#7X3:2]       |  644.6 |    677.8 | <400   |
  | [#6X3:1]:[#7X2,#7X3+1:2]           |  760.4 |    920.9 | <      |
  | [#6X4:1]-[#7X3:2]-[#6X3]=[#8X1+0]  |  467.4 |    570.0 | <      |
  | [#6X3:1]=[#7X2,#7X3+1:2]           | 1023.3 |   1018.6 | <400   |
  | [#16X4,#16X3:1]~[#8X1:2]           | 1140.5 |   1133.3 | >      |
  | [#6X4:1]-[#6X3:2]=[#8X1+0]         |  418.6 |    433.8 | <300   |
  | [#6X3a:1]-[#8X2H0:2]               |  650.6 |    674.9 | >900   |
  | [#16X4,#16X3!+1:1]-[#6:2]          |  332.8 |    269.1 | >      |
  | [#6X3:1]-[#7X2:2]                  |  566.5 |    679.8 | <400   |
  | [#16X2,#16X1-1,#16X3+1:1]-[#6X3:2] |  365.1 |    386.4 | <300   |
  | [#8:1]-[#1:2]                      | 1069.8 |   1051.0 | >      |
  | [#6:1]-[#17:2]                     |  368.4 |    432.9 | n      |
  | [#6X4:1]-[#9:2]                    |  535.7 |    697.1 | n      |
  | [#6X3:1]-[#8X2:2]                  |  599.0 |    623.7 | <400   |
  | [#6:1]-[#9:2]                      |  710.2 |    796.0 | n      |
  | [#7X3:1]-[#7X2:2]                  |  620.4 |    455.4 | n      |
  | [#6:1]-[#8:2]                      |  545.3 |    599.9 | <      |
  | [#6X3:1](=[#8X1])-[#8X2H0:2]       |  584.3 |    647.9 | <      |
  | [#6X3:1]-[#8X2H1:2]                |  674.0 |    714.1 | n      |
  | [#16X4,#16X3:1]~[#7:2]             |  335.3 |    347.1 | n      |
  | [#6X3:1](~[#8X1])~[#8X1:2]           | 1187.2 |    772.7 | n      |
  | [#16X2,#16X1-1,#16X3+1:1]-[#6X4:2] |  281.0 |    298.0 | n      |
  | [#6X2:1]-[#6:2]                    |  669.7 |    722.8 | n      |
  | [#6:1]#[#7:2]                      | 2687.7 |   2652.6 | n      |
  | [#7:1]-[#8X2:2]                    |  436.5 |    425.9 | n      |
  | [#6:1]-[#35:2]                     |  307.3 |    352.0 | n      |
  | [#7X2:1]-[#7X2:2]                  |  472.8 |    682.3 | <      |
  | [#15:1]~[#8X2:2]                   |  503.9 |    602.4 | n      |
  | [#7:1]~[#8X1:2]                    | 1182.0 |   1342.4 | n      |
  | [#7:1]=[#7:2]                      | 1089.1 |    947.1 | n      |
  | [#7:1]-[#7:2]                      |  578.3 |    520.2 | n      |
  | [#16X4,#16X3:1]~[#7X2:2]           |  334.6 |    295.1 | n      |
  | [#15:1]-[#7:2]                     |  543.2 |    424.6 | n      |
  | [#16X4,#16X3:1]-[#8X2:2]           |  290.5 |    373.6 | n      |
  | [#6X4:1]-[#17:2]                   |  244.0 |    362.9 | n      |
  | [#16:1]-[#15:2]                    |  261.9 |    283.0 | n      |
  | [#16X2:1]-[#8X2:2]                 |  389.1 |    192.3 | n      |
  | [#6X2:1]-[#6X4:2]                  |  600.5 |    655.5 | n      |
  | [#15:1]~[#8X1:2]                   | 1310.2 |   1285.5 | n      |
  | [#16X2,#16X1-1:1]-[#7:2]           |  195.0 |    417.5 | n      |
  | [#15:1]=[#16X1:2]                  |  447.2 |    420.2 | n      |
  | [#16:1]=[#6:2]                     |  542.9 |    527.6 | n      |
  | [#6X2:1]#[#6X2:2]                  | 2349.4 |   2276.0 | n      |
  | [#6X3:1]-[#8X1-1:2]                | 1090.1 |   1486.1 | n      |
  | [#16:1]-[#1:2]                     |  589.6 |    558.2 | n      |
  | [#6X2:1]-[#1:2]                    |  932.2 |    874.2 | n      |
  | [#6X4:1]-[#35:2]                   |  208.7 |    263.4 | n      |
  | [#7:1]:[#7:2]                      |  661.9 |    740.2 | n      |
  | [#16:1]-[#16:2]                    |  273.4 |    110.2 | n      |
  | [#7:1]-[#9:2]                      |  454.2 |    333.6 | n      |
  | [#6X2:1]=[#7:2]                    | 1902.7 |   2280.8 | n      |
  | [#6X2:1]=[#6X3:2]                  | 1338.6 |   1170.7 | n      |
  | [#6X2:1]=[#16:2]                   |  864.8 |    764.8 | n      |
  | [#15:1]=[#7:2]                     |  733.9 |    389.8 | n      |
  | [#15:1]-[#17:2]                    |  283.9 |    283.4 | n      |
  | [#6X2:1]-[#7:2]                    |  935.8 |    894.4 | n      |
  | [#6X3:1]~[#8X2+1:2]~[#6X3]         |  603.6 |    661.8 | n      |
  | [#6X2:1]-[#8X2:2]                  |  923.0 |    713.6 | n      |
  | [#7+1:1]=[#7-1:2]                  | 2440.2 |   1506.1 | n      |
  | [#15:1]-[#1:2]                     |  499.6 |    468.7 | n      |
  | [#7:1]#[#7:2]                      | 3236.6 |   2203.7 | n      |
  | [#15:1]-[#35:2]                    |  232.8 |     93.1 | n      |
  | [#16:1]-[#17:2]                    |  176.8 |    253.8 | n      |
  | [#16X2:1]=[#8X1,#7X2:2]            |  991.9 |   1303.7 | n      |
  | [#7:1]-[#17:2]                     |  294.5 |    236.5 | n      |
  | [#15:1]~[#6:2]                     |  356.0 |    318.6 | n      |
  | [#8X2:1]-[#8X2,#8X1-1:2]           |  425.4 |    446.4 | n      |
  | [#16:1]-[#35:2]                    |  162.5 |    216.2 | n      |
  | [#7:1]-[#35:2]                     |  322.6 |    328.0 | n      |
  | [#16:1]-[#6:2]                     |  474.0 |    307.3 | n      |
